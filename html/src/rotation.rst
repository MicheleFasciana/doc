.. |exb| mathmacro:: \mathbf{E}\times\mathbf{B}

PLASMA ROTATION AND FIELD ORIENTATION
=====================================

Physical considerations
-----------------------

Sonic rotation can arise in tokamaks from torque due to neutral beam injection.  It is
believed to play an important role in the suppression of turbulence and the formation of
transport barriers through :math:`\exb` shear.  In addition, it
produces a strong centrifugal force that pushes ions toroidally outward, causing them to
redistribute nonuniformly around a flux surface.  As a result of quasi-neutrality, a
poloidally-varying electrostatic potential is generated by the electrons to balance the
density asymmetry.  This induces centrifugal drifts and trapping, in addition to the usual
:math:`\exb` rotation, Coriolis drift, and parallel velocity shear.
Because of their complexity, these centrifugal effects, which are second-order in the main
ion Mach number, are ignored in most neoclassical and gyrokinetic codes.  Inclusion of full
sonic rotation effects is particularly critical for studying transport of heavy impurities,
as the influence of the centrifugal force is amplified by their large mass.

Sonic rotation formalism
------------------------

There is some confusion regarding the proper inputs to characterize rotation.  The rigorous
derivation of the gyrokinetic equations for sonic rotation was carried out by Sugama [Phys.
Plasmas 5, 2560 (1998)].  Sugama followed the underlying rotation formulation of Hinton
and Wong [Phys. Fluids 28, 3082 (1985)], who showed that in an axisymmetric system the
zeroth-order flow velocity is

.. math::

   \mathbf{U}_0 = \omega_0(\psi) R^2 \nabla \varphi \; .

It is this scalar flux-function, :math:`\omega_0`, that is the true free (input) function in
neoclassical and gyrokinetic theory.  Here, :math:`\psi` is the poloidal flux.

The Rotation Profile
--------------------

The relevant profile that gives a *complete specification of rotation*
is the potential :math:`\omega_0(r)`, which in defined consistently in GACODE as

.. math::

   \omega_0(r) = -c \frac{d \Phi}{d \psi} \simeq \frac{c E_r }{R B_p} \; .

In the strictest sense, :math:`\Phi(r)` above is the leading-order potential that is constant on
a flux surface.  Because the meaning of :math:`\Phi(r)` is ambiguous in an experimental sense,
it is perhaps most useful to rely on the final expression in terms of :math:`E_r`.  We believe
this form is intuitively appealing and connects most clearly with experimental data.   

Input parameters
----------------

CGYRO has recently been upgraded to implement *full sonic rotation*, whereas GYRO implements
only a reduced model which includes rotation terms that are first-order in the main ion Mach number;
that is, GYRO includes the :math:`\exb` rotation, Coriolis drift, and parallel velocity shear but
not centrifugal dynamics.  In GYRO and CGYRO, the input rotation parameters are as follows:

- :math:`\exb` shearing rate: 

.. math::

    \mathtt{GAMMA\_E} \rightarrow \frac{a}{c_s} \, \gamma_{\rm E} \doteq -\frac{r}{q}\frac{\partial \omega_{0}}{\partial r}

- Rotation shearing rate (PGAMMA in GYRO):

.. math::

   \mathtt{GAMMA\_P} \rightarrow \frac{a}{c_s} \, \gamma_p \doteq -R_0\frac{\partial \omega_{0}}{\partial r}

- Toroidal flow Mach number: MACH

.. math::

    \mathtt{MACH} \rightarrow M \doteq \frac{\omega_0 R_0}{c_s}

Like CGYRO, NEO also implements all sonic rotation terms, including centrifugal effects,
according to the formulation of Hinton and Wong [Phys. Fluids 28, 3082 (1985)].  Neoclassically,
the induced poloidally-varying electrostatic potential leads to the formation of potential wells.
In the banana regime these increase the effective trapped particle fraction, and in the
Pfirsh-Schluter regime increase the effective toroidal curvature.  In both instances, this
may lead to enhanced neoclassical transport.  The NEO input rotation parameters are as follows:

- Rotation rate

.. math::

   \mathtt{OMEGA\_ROT} \rightarrow \frac{a}{v_{norm}} \omega_0 

- Derivative of rotation rate

.. math::

  \mathtt{OMEGA\_ROT\_DERIV} \rightarrow \frac{a^{2}}{v_{norm}} \frac{d \omega_{0}}{dr} 

and the rotation model controlled by ROTATION_MODEL.
