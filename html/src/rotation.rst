ROTATION AND FIELD ORIENTATION
==============================

Rotation
--------

Sonic rotation can arise in tokamaks from torque due to neutral beam injection.  It is
believed to play an important role in the suppression of turbulence and the formation of
transport barriers through :math:`\mathbf{E}\times\mathbf{B}` shear.  In addition, it
produces a strong centrifugal force that pushes ions toroidally outward, causing them to
redistribute non-uniformly around a flux surface.  As a result of quasi-neutrality, a
poloidally-varying electrostatic potential is generated by the electrons to balance the
density asymmetry.  This induces centrifugal drifts and trapping, in addition to the usual
:math:`\mathbf{E}\times\mathbf{B}` rotation, Coriolis drift, and parallel velocity shear.
Because of their complexity, these centrifugal effects, which are second-order in the main
ion Mach number, are ignored in most neoclassical gyrokinetic codes.  Inclusion of full
sonic rotation effects is particularly critical for studying transport of heavy impurities,
as the influence of the centrifugal force is amplified by their large mass.

CGYRO has recently been upgraded to implement full sonic rotation effects, according to the
formulation of Sugama (Phys. Plasmas 5, 2560 (1998)).  GYRO implements a reduced model which
includes only rotation effects which are first-order in the main ion Mach number (i.e. it
includes the ExB rotation, Coriolis drift, and parallel velocity shear but neglected the
second-order centrifugal effects).  In GYRO and CGYRO, the input rotation parameters are
as follows:

- :math:`E \times B` shearing rate: [[GAMMA_E]]: :math:`\gamma_{\rm E} \frac{a}{c_s} = -\frac{r}{q}\frac{\partial \omega_{0}}{\partial r}`
- Rotation shearing rate: [[PGAMMA]] or GAMMA_P: :math:`\gamma_p \frac{a}{c_s} = -R_0\frac{\partial \omega_{0}}{\partial r}`
- Toroidal flow Mach number: [[MACH]]: :math:`M = \frac{\omega_0 R_0}{c_s}`

Like CGYRO, NEO also implements full sonic rotation effects, including centrifugal effects,
according to the formulation of Hinton and Wong (Phys. Fluids 28, 3082 (1985)).  Neoclassically,
the induced poloidally-varying electrostatic potential leads to the formation of potential wells,
which, in the banana regime increases the effective trapped particle fraction, and, in the
Pfirsh-Schluter regime increases the effective toroidal curvature, in each case leading to
possibly enhanced neoclassical transport.  The NEO input rotation parameters are as follows:

- [[ROTATION_MODEL-neo|ROTATION_MODEL]]
- [[OMEGA_ROT-neo|OMEGA_ROT]]: <math>\frac{\omega_{0}}{v_{norm}/a} </math>
- [[OMEGA_ROT_DERIV-neo|OMEGA_ROT_DERIV]]: <math> \frac{d \omega_{0}}{dr} \frac{a^{2}}{v_{norm}} </math>
